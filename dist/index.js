"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class Variable{constructor(t,r=null,e=null){this.name=t,this.fallbackType=r,this.fallback=e,this.kind=2}stringify(t,r=!0){const e=t[this.name];return e?r?e.trim().replace(/\s+/g," "):e:this.fallback?this.fallback.stringify(t,r):null}toString(){return"${"+this.name+(this.fallbackType||"")+(this.fallback||"")+"}"}}class QuotedString{constructor(t){this.contents=t,this.kind=4}stringify(t){return this.contents.reduce((r,e)=>("string"!=typeof e&&(e=e.stringify(t,!1)||""),r+e),"")}toString(){return`"${this.contents}"`}}class VerbatimString{constructor(t){this.contents=t,this.kind=5}stringify(){return this.contents}toString(){return`'${this.contents}'`}}class Word{constructor(t){this.contents=t,this.kind=3}stringify(){return this.contents}toString(){return`(${this.contents})`}}class List{constructor(t){this.items=t,this.kind=0}stringify(t,r=!0){if(r){let r=!1;return this.items.reduce((e,n)=>{if(1===n.kind)return r=!0,e;const i=n.stringify(t,!0);return null===i?e:(r&&""!==e&&(e+=" "),r=!1,e+i)},"")}return this.items.map(r=>r.stringify(t,!1)).filter(t=>null!==t).join("")}toString(){return`[${this.items}]`}}!function(t){t[t.List=0]="List",t[t.Whitespace=1]="Whitespace",t[t.Variable=2]="Variable",t[t.Text=3]="Text",t[t.QuotedText=4]="QuotedText",t[t.LiteralText=5]="LiteralText"}(exports.TokenKind||(exports.TokenKind={}));var tokens=Object.freeze({__proto__:null,Variable:Variable,QuotedString:QuotedString,VerbatimString:VerbatimString,Word:Word,List:List,get TokenKind(){return exports.TokenKind}}),parser="use strict";function peg$subclass(t,r){function e(){this.constructor=t}e.prototype=r.prototype,t.prototype=new e}function peg$SyntaxError(t,r,e,n){this.message=t,this.expected=r,this.found=e,this.location=n,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,peg$SyntaxError)}function peg$parse(t,r){r=void 0!==r?r:{};var e,n={},i={start:tt},o=tt,a=function(t){return new xt(t)},s="${",c=I("${",!1),u=":-",l=I(":-",!1),f=":=",h=I(":=",!1),p="}",g=I("}",!1),d=function(t,r,e){return new dt(t,r,e)},A=function(t){return new dt(t)},x="$",y=I("$",!1),v=function(){return new gt("$")},b=function(t){return 1===t.length?t[0]:new xt(t)},C={type:"other",description:"variable name"},S=/^[a-zA-Z_]/,m=J([["a","z"],["A","Z"],"_"],!1,!1),$=/^[a-zA-z_0-9]/,k=J([["a","z"],["A","z"],"_",["0","9"]],!1,!1),w=function(){return H()},E=/^[ \t\n\r]/,T=J([" ","\t","\n","\r"],!1,!1),V=function(){return new yt(H())},_="'",L=I("'",!1),W=function(t){return new gt(t)},F='"',Q=I('"',!1),z=function(t){return new pt(t)},j=function(){return new At(H())},K="\\",R=I("\\",!1),M=function(t){return t},O={type:"any"},Z=function(t){return t},P=0,U=0,q=[{line:1,column:1}],B=0,D=[],G=0;if("startRule"in r){if(!(r.startRule in i))throw new Error("Can't start parsing from rule \""+r.startRule+'".');o=i[r.startRule]}function H(){return t.substring(U,P)}function I(t,r){return{type:"literal",text:t,ignoreCase:r}}function J(t,r,e){return{type:"class",parts:t,inverted:r,ignoreCase:e}}function N(r){var e,n=q[r];if(n)return n;for(e=r-1;!q[e];)e--;for(n={line:(n=q[e]).line,column:n.column};e<r;)10===t.charCodeAt(e)?(n.line++,n.column=1):n.column++,e++;return q[r]=n,n}function X(t,r){var e=N(t),n=N(r);return{start:{offset:t,line:e.line,column:e.column},end:{offset:r,line:n.line,column:n.column}}}function Y(t){P<B||(P>B&&(B=P,D=[]),D.push(t))}function tt(){var t,r,e;for(t=P,r=[],e=rt();e!==n;)r.push(e),e=rt();return r!==n&&(U=t,r=a(r)),t=r}function rt(){var t;return(t=ot())===n&&(t=at())===n&&(t=et())===n&&(t=function(){var t,r,e;if(t=P,r=[],(e=ht())!==n)for(;e!==n;)r.push(e),e=ht();else r=n;r!==n&&(U=t,r=j());return t=r}())===n&&(t=it()),t}function et(){var r,e,i,o,a,C;return r=P,t.substr(P,2)===s?(e=s,P+=2):(e=n,0===G&&Y(c)),e!==n&&(i=nt())!==n?(t.substr(P,2)===u?(o=u,P+=2):(o=n,0===G&&Y(l)),o===n&&(t.substr(P,2)===f?(o=f,P+=2):(o=n,0===G&&Y(h))),o!==n&&(a=function(){var t,r,e;t=P,r=[],(e=ot())===n&&(e=at())===n&&(e=et())===n&&(e=st())===n&&(e=it());for(;e!==n;)r.push(e),(e=ot())===n&&(e=at())===n&&(e=et())===n&&(e=st())===n&&(e=it());r!==n&&(U=t,r=b(r));return t=r}())!==n?(125===t.charCodeAt(P)?(C=p,P++):(C=n,0===G&&Y(g)),C!==n?(U=r,r=e=d(i,o,a)):(P=r,r=n)):(P=r,r=n)):(P=r,r=n),r===n&&(r=P,t.substr(P,2)===s?(e=s,P+=2):(e=n,0===G&&Y(c)),e!==n&&(i=nt())!==n?(125===t.charCodeAt(P)?(o=p,P++):(o=n,0===G&&Y(g)),o!==n?(U=r,r=e=A(i)):(P=r,r=n)):(P=r,r=n),r===n&&(r=P,36===t.charCodeAt(P)?(e=x,P++):(e=n,0===G&&Y(y)),e!==n&&(i=nt())!==n?(U=r,r=e=A(i)):(P=r,r=n),r===n&&(r=P,36===t.charCodeAt(P)?(e=x,P++):(e=n,0===G&&Y(y)),e!==n&&(U=r,e=v()),r=e))),r}function nt(){var r,e,i,o;if(G++,r=P,S.test(t.charAt(P))?(e=t.charAt(P),P++):(e=n,0===G&&Y(m)),e!==n){if(i=[],$.test(t.charAt(P))?(o=t.charAt(P),P++):(o=n,0===G&&Y(k)),o!==n)for(;o!==n;)i.push(o),$.test(t.charAt(P))?(o=t.charAt(P),P++):(o=n,0===G&&Y(k));else i=n;i!==n?(U=r,r=e=w()):(P=r,r=n)}else P=r,r=n;return G--,r===n&&(e=n,0===G&&Y(C)),r}function it(){var r,e,i;if(r=P,e=[],E.test(t.charAt(P))?(i=t.charAt(P),P++):(i=n,0===G&&Y(T)),i!==n)for(;i!==n;)e.push(i),E.test(t.charAt(P))?(i=t.charAt(P),P++):(i=n,0===G&&Y(T));else e=n;return e!==n&&(U=r,e=V()),r=e}function ot(){var r,e,i,o;return r=P,39===t.charCodeAt(P)?(e=_,P++):(e=n,0===G&&Y(L)),e!==n&&(i=function(){var t,r,e;if(t=P,r=[],(e=lt())!==n)for(;e!==n;)r.push(e),e=lt();else r=n;r!==n&&(U=t,r=w());return t=r}())!==n?(39===t.charCodeAt(P)?(o=_,P++):(o=n,0===G&&Y(L)),o!==n?(U=r,r=e=W(i)):(P=r,r=n)):(P=r,r=n),r}function at(){var r,e,i,o;if(r=P,34===t.charCodeAt(P)?(e=F,P++):(e=n,0===G&&Y(Q)),e!==n){for(i=[],(o=ct())===n&&(o=et());o!==n;)i.push(o),(o=ct())===n&&(o=et());i!==n?(34===t.charCodeAt(P)?(o=F,P++):(o=n,0===G&&Y(Q)),o!==n?(U=r,r=e=z(i)):(P=r,r=n)):(P=r,r=n)}else P=r,r=n;return r}function st(){var t,r,e;if(t=P,r=[],(e=ft())!==n)for(;e!==n;)r.push(e),e=ft();else r=n;return r!==n&&(U=t,r=j()),t=r}function ct(){var t,r,e;if(t=P,r=[],(e=ut())!==n)for(;e!==n;)r.push(e),e=ut();else r=n;return r!==n&&(U=t,r=w()),t=r}function ut(){var r,e,i;return r=P,92===t.charCodeAt(P)?(e=K,P++):(e=n,0===G&&Y(R)),e!==n?(36===t.charCodeAt(P)?(i=x,P++):(i=n,0===G&&Y(y)),i===n&&(34===t.charCodeAt(P)?(i=F,P++):(i=n,0===G&&Y(Q))),i!==n?(U=r,r=e=M(i)):(P=r,r=n)):(P=r,r=n),r===n&&(r=P,e=P,G++,36===t.charCodeAt(P)?(i=x,P++):(i=n,0===G&&Y(y)),i===n&&(34===t.charCodeAt(P)?(i=F,P++):(i=n,0===G&&Y(Q))),G--,i===n?e=void 0:(P=e,e=n),e!==n?(t.length>P?(i=t.charAt(P),P++):(i=n,0===G&&Y(O)),i!==n?(U=r,r=e=Z(i)):(P=r,r=n)):(P=r,r=n)),r}function lt(){var r,e,i;return r=P,92===t.charCodeAt(P)?(e=K,P++):(e=n,0===G&&Y(R)),e!==n?(39===t.charCodeAt(P)?(i=_,P++):(i=n,0===G&&Y(L)),i!==n?(U=r,r=e=M(i)):(P=r,r=n)):(P=r,r=n),r===n&&(r=P,e=P,G++,39===t.charCodeAt(P)?(i=_,P++):(i=n,0===G&&Y(L)),G--,i===n?e=void 0:(P=e,e=n),e!==n?(t.length>P?(i=t.charAt(P),P++):(i=n,0===G&&Y(O)),i!==n?(U=r,r=e=Z(i)):(P=r,r=n)):(P=r,r=n)),r}function ft(){var r,e,i;return r=P,92===t.charCodeAt(P)?(e=K,P++):(e=n,0===G&&Y(R)),e!==n?(36===t.charCodeAt(P)?(i=x,P++):(i=n,0===G&&Y(y)),i===n&&(125===t.charCodeAt(P)?(i=p,P++):(i=n,0===G&&Y(g))),i!==n?(U=r,r=e=M(i)):(P=r,r=n)):(P=r,r=n),r===n&&(r=P,e=P,G++,36===t.charCodeAt(P)?(i=x,P++):(i=n,0===G&&Y(y)),i===n&&(125===t.charCodeAt(P)?(i=p,P++):(i=n,0===G&&Y(g)),i===n&&(i=it())),G--,i===n?e=void 0:(P=e,e=n),e!==n?(t.length>P?(i=t.charAt(P),P++):(i=n,0===G&&Y(O)),i!==n?(U=r,r=e=Z(i)):(P=r,r=n)):(P=r,r=n)),r}function ht(){var r,e,i;return r=P,92===t.charCodeAt(P)?(e=K,P++):(e=n,0===G&&Y(R)),e!==n?(36===t.charCodeAt(P)?(i=x,P++):(i=n,0===G&&Y(y)),i!==n?(U=r,r=e=M(i)):(P=r,r=n)):(P=r,r=n),r===n&&(r=P,e=P,G++,36===t.charCodeAt(P)?(i=x,P++):(i=n,0===G&&Y(y)),i===n&&(i=it()),G--,i===n?e=void 0:(P=e,e=n),e!==n?(t.length>P?(i=t.charAt(P),P++):(i=n,0===G&&Y(O)),i!==n?(U=r,r=e=Z(i)):(P=r,r=n)):(P=r,r=n)),r}const{QuotedString:pt,VerbatimString:gt,Variable:dt,Word:At,List:xt,Whitespace:yt}=tokens;if((e=o())!==n&&P===t.length)return e;throw e!==n&&P<t.length&&Y({type:"end"}),vt=D,bt=B<t.length?t.charAt(B):null,Ct=B<t.length?X(B,B+1):X(B,B),new peg$SyntaxError(peg$SyntaxError.buildMessage(vt,bt),vt,bt,Ct);var vt,bt,Ct}peg$subclass(peg$SyntaxError,Error),peg$SyntaxError.buildMessage=function(t,r){var e={literal:function(t){return'"'+i(t.text)+'"'},class:function(t){var r,e="";for(r=0;r<t.parts.length;r++)e+=t.parts[r]instanceof Array?o(t.parts[r][0])+"-"+o(t.parts[r][1]):o(t.parts[r]);return"["+(t.inverted?"^":"")+e+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function i(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function o(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}return"Expected "+function(t){var r,n,i,o=new Array(t.length);for(r=0;r<t.length;r++)o[r]=(i=t[r],e[i.type](i));if(o.sort(),o.length>0){for(r=1,n=1;r<o.length;r++)o[r-1]!==o[r]&&(o[n]=o[r],n++);o.length=n}switch(o.length){case 1:return o[0];case 2:return o[0]+" or "+o[1];default:return o.slice(0,-1).join(", ")+", or "+o[o.length-1]}}(t)+" but "+function(t){return t?'"'+i(t)+'"':"end of input"}(r)+" found."};var parser_1=(parser={SyntaxError:peg$SyntaxError,parse:peg$parse}).parse;const parse=t=>parser_1(t),replace=(t,r)=>{return parser_1(t).stringify(r)};exports.List=List,exports.QuotedString=QuotedString,exports.Variable=Variable,exports.VerbatimString=VerbatimString,exports.Word=Word,exports.parse=parse,exports.replace=replace;
//# sourceMappingURL=index.js.map
