"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class Variable{constructor(t,r=null,e=null){this.name=t,this.fallbackType=r,this.fallback=e,this.kind=2}stringify(t,r=!0){const e=t[this.name];return e?r?e.trim().replace(/\s+/g," "):e:this.fallback?this.fallback.stringify(t,r):null}toString(){return"${"+this.name+(this.fallbackType||"")+(this.fallback||"")+"}"}}class QuotedString{constructor(t){this.contents=t,this.kind=4}stringify(t){return this.contents.reduce((r,e)=>("string"!=typeof e&&(e=e.stringify(t,!1)||""),r+e),"")}toString(){return`"${this.contents}"`}}class VerbatimString{constructor(t){this.contents=t,this.kind=5}stringify(){return this.contents}toString(){return`'${this.contents}'`}}class Word{constructor(t){this.contents=t,this.kind=3}stringify(){return this.contents}toString(){return`(${this.contents})`}}class List{constructor(t){this.items=t,this.kind=0}stringify(t,r=!0){if(r){let r=!1;return this.items.reduce((e,n)=>{if(1===n.kind)return r=!0,e;const i=n.stringify(t,!0);return null===i?e:(r&&""!==e&&(e+=" "),r=!1,e+i)},"")}return this.items.map(r=>r.stringify(t,!1)).filter(t=>null!==t).join("")}toString(){return`[${this.items}]`}}class Whitespace{constructor(t){this.contents=t,this.kind=1}stringify(t,r=!0){return r?" ":this.contents}toString(){return`(${this.contents})`}}!function(t){t[t.List=0]="List",t[t.Whitespace=1]="Whitespace",t[t.Variable=2]="Variable",t[t.Text=3]="Text",t[t.QuotedText=4]="QuotedText",t[t.LiteralText=5]="LiteralText"}(exports.TokenKind||(exports.TokenKind={}));var tokens=Object.freeze({__proto__:null,Variable:Variable,QuotedString:QuotedString,VerbatimString:VerbatimString,Word:Word,List:List,Whitespace:Whitespace,get TokenKind(){return exports.TokenKind}}),parser="use strict";function peg$subclass(t,r){function e(){this.constructor=t}e.prototype=r.prototype,t.prototype=new e}function peg$SyntaxError(t,r,e,n){this.message=t,this.expected=r,this.found=e,this.location=n,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,peg$SyntaxError)}function peg$parse(t,r){r=void 0!==r?r:{};var e,n={},i={start:ct},o=ct,s=function(t){return new wt(t)},a="${",c=nt("${",!1),u=":-",l=nt(":-",!1),f=":=",h=nt(":=",!1),p="}",g=nt("}",!1),d=function(t,r,e){return new kt(t,r,e)},x=function(t){return new kt(t)},A="$",y=nt("$",!1),b=function(){return new $t("$")},v=function(t){return 1===t.length?t[0]:new wt(t)},S={type:"other",description:"variable name"},m=/^[a-zA-Z_]/,$=it([["a","z"],["A","Z"],"_"],!1,!1),k=/^[a-zA-z_0-9]/,C=it([["a","z"],["A","z"],"_",["0","9"]],!1,!1),w=function(){return et()},E=/^[ \t\n\r]/,T=it([" ","\t","\n","\r"],!1,!1),V=function(){return new Et(et())},W="'",_=nt("'",!1),L=function(t){return new $t(t)},F='"',Q=nt('"',!1),z=function(t){return new mt(t)},j=function(t){return new Ct(t.join(""))},K=function(t){return t.join("")},R="\\",M=nt("\\",!1),O=/^[$"`\\]/,Z=it(["$",'"',"`","\\"],!1,!1),P=function(t){return t},U="\\\n",q=nt("\\\n",!1),B=function(){return""},D=/^[$"]/,G=it(["$",'"'],!1,!1),H={type:"any"},I=function(t){return t},J=0,N=0,X=[{line:1,column:1}],Y=0,tt=[],rt=0;if("startRule"in r){if(!(r.startRule in i))throw new Error("Can't start parsing from rule \""+r.startRule+'".');o=i[r.startRule]}function et(){return t.substring(N,J)}function nt(t,r){return{type:"literal",text:t,ignoreCase:r}}function it(t,r,e){return{type:"class",parts:t,inverted:r,ignoreCase:e}}function ot(r){var e,n=X[r];if(n)return n;for(e=r-1;!X[e];)e--;for(n={line:(n=X[e]).line,column:n.column};e<r;)10===t.charCodeAt(e)?(n.line++,n.column=1):n.column++,e++;return X[r]=n,n}function st(t,r){var e=ot(t),n=ot(r);return{start:{offset:t,line:e.line,column:e.column},end:{offset:r,line:n.line,column:n.column}}}function at(t){J<Y||(J>Y&&(Y=J,tt=[]),tt.push(t))}function ct(){var t,r,e;for(t=J,r=[],e=ut();e!==n;)r.push(e),e=ut();return r!==n&&(N=t,r=s(r)),t=r}function ut(){var t;return(t=pt())===n&&(t=gt())===n&&(t=function(){var t,r,e;if(t=J,r=[],(e=vt())!==n)for(;e!==n;)r.push(e),e=vt();else r=n;r!==n&&(N=t,r=j(r));return t=r}())===n&&(t=lt())===n&&(t=ht()),t}function lt(){var r,e,i,o,s,S;return r=J,t.substr(J,2)===a?(e=a,J+=2):(e=n,0===rt&&at(c)),e!==n&&(i=ft())!==n?(t.substr(J,2)===u?(o=u,J+=2):(o=n,0===rt&&at(l)),o===n&&(t.substr(J,2)===f?(o=f,J+=2):(o=n,0===rt&&at(h))),o!==n&&(s=function(){var t,r,e;t=J,r=[],(e=pt())===n&&(e=gt())===n&&(e=dt())===n&&(e=lt())===n&&(e=ht());for(;e!==n;)r.push(e),(e=pt())===n&&(e=gt())===n&&(e=dt())===n&&(e=lt())===n&&(e=ht());r!==n&&(N=t,r=v(r));return t=r}())!==n?(125===t.charCodeAt(J)?(S=p,J++):(S=n,0===rt&&at(g)),S!==n?(N=r,r=e=d(i,o,s)):(J=r,r=n)):(J=r,r=n)):(J=r,r=n),r===n&&(r=J,t.substr(J,2)===a?(e=a,J+=2):(e=n,0===rt&&at(c)),e!==n&&(i=ft())!==n?(125===t.charCodeAt(J)?(o=p,J++):(o=n,0===rt&&at(g)),o!==n?(N=r,r=e=x(i)):(J=r,r=n)):(J=r,r=n),r===n&&(r=J,36===t.charCodeAt(J)?(e=A,J++):(e=n,0===rt&&at(y)),e!==n&&(i=ft())!==n?(N=r,r=e=x(i)):(J=r,r=n),r===n&&(r=J,36===t.charCodeAt(J)?(e=A,J++):(e=n,0===rt&&at(y)),e!==n&&(N=r,e=b()),r=e))),r}function ft(){var r,e,i,o;if(rt++,r=J,m.test(t.charAt(J))?(e=t.charAt(J),J++):(e=n,0===rt&&at($)),e!==n){if(i=[],k.test(t.charAt(J))?(o=t.charAt(J),J++):(o=n,0===rt&&at(C)),o!==n)for(;o!==n;)i.push(o),k.test(t.charAt(J))?(o=t.charAt(J),J++):(o=n,0===rt&&at(C));else i=n;i!==n?(N=r,r=e=w()):(J=r,r=n)}else J=r,r=n;return rt--,r===n&&(e=n,0===rt&&at(S)),r}function ht(){var r,e,i;if(r=J,e=[],E.test(t.charAt(J))?(i=t.charAt(J),J++):(i=n,0===rt&&at(T)),i!==n)for(;i!==n;)e.push(i),E.test(t.charAt(J))?(i=t.charAt(J),J++):(i=n,0===rt&&at(T));else e=n;return e!==n&&(N=r,e=V()),r=e}function pt(){var r,e,i,o;return r=J,39===t.charCodeAt(J)?(e=W,J++):(e=n,0===rt&&at(_)),e!==n&&(i=function(){var t,r,e;if(t=J,r=[],(e=yt())!==n)for(;e!==n;)r.push(e),e=yt();else r=n;r!==n&&(N=t,r=K(r));return t=r}())!==n?(39===t.charCodeAt(J)?(o=W,J++):(o=n,0===rt&&at(_)),o!==n?(N=r,r=e=L(i)):(J=r,r=n)):(J=r,r=n),r}function gt(){var r,e,i,o;if(r=J,34===t.charCodeAt(J)?(e=F,J++):(e=n,0===rt&&at(Q)),e!==n){for(i=[],(o=xt())===n&&(o=lt());o!==n;)i.push(o),(o=xt())===n&&(o=lt());i!==n?(34===t.charCodeAt(J)?(o=F,J++):(o=n,0===rt&&at(Q)),o!==n?(N=r,r=e=z(i)):(J=r,r=n)):(J=r,r=n)}else J=r,r=n;return r}function dt(){var t,r,e;if(t=J,r=[],(e=bt())!==n)for(;e!==n;)r.push(e),e=bt();else r=n;return r!==n&&(N=t,r=j(r)),t=r}function xt(){var t,r,e;if(t=J,r=[],(e=At())!==n)for(;e!==n;)r.push(e),e=At();else r=n;return r!==n&&(N=t,r=K(r)),t=r}function At(){var r,e,i;return r=J,92===t.charCodeAt(J)?(e=R,J++):(e=n,0===rt&&at(M)),e!==n?(O.test(t.charAt(J))?(i=t.charAt(J),J++):(i=n,0===rt&&at(Z)),i!==n?(N=r,r=e=P(i)):(J=r,r=n)):(J=r,r=n),r===n&&(r=J,t.substr(J,2)===U?(e=U,J+=2):(e=n,0===rt&&at(q)),e!==n&&(N=r,e=B()),(r=e)===n&&(r=J,e=J,rt++,D.test(t.charAt(J))?(i=t.charAt(J),J++):(i=n,0===rt&&at(G)),rt--,i===n?e=void 0:(J=e,e=n),e!==n?(t.length>J?(i=t.charAt(J),J++):(i=n,0===rt&&at(H)),i!==n?(N=r,r=e=I(i)):(J=r,r=n)):(J=r,r=n))),r}function yt(){var r,e,i;return r=J,e=J,rt++,39===t.charCodeAt(J)?(i=W,J++):(i=n,0===rt&&at(_)),rt--,i===n?e=void 0:(J=e,e=n),e!==n?(t.length>J?(i=t.charAt(J),J++):(i=n,0===rt&&at(H)),i!==n?(N=r,r=e=I(i)):(J=r,r=n)):(J=r,r=n),r}function bt(){var r,e,i;return(r=St())===n&&(r=J,e=J,rt++,36===t.charCodeAt(J)?(i=A,J++):(i=n,0===rt&&at(y)),i===n&&(125===t.charCodeAt(J)?(i=p,J++):(i=n,0===rt&&at(g)),i===n&&(i=ht())),rt--,i===n?e=void 0:(J=e,e=n),e!==n?(t.length>J?(i=t.charAt(J),J++):(i=n,0===rt&&at(H)),i!==n?(N=r,r=e=I(i)):(J=r,r=n)):(J=r,r=n)),r}function vt(){var r,e,i;return(r=St())===n&&(r=J,e=J,rt++,36===t.charCodeAt(J)?(i=A,J++):(i=n,0===rt&&at(y)),i===n&&(i=ht()),rt--,i===n?e=void 0:(J=e,e=n),e!==n?(t.length>J?(i=t.charAt(J),J++):(i=n,0===rt&&at(H)),i!==n?(N=r,r=e=I(i)):(J=r,r=n)):(J=r,r=n)),r}function St(){var r,e,i;return r=J,t.substr(J,2)===U?(e=U,J+=2):(e=n,0===rt&&at(q)),e!==n&&(N=r,e=B()),(r=e)===n&&(r=J,92===t.charCodeAt(J)?(e=R,J++):(e=n,0===rt&&at(M)),e!==n?(t.length>J?(i=t.charAt(J),J++):(i=n,0===rt&&at(H)),i!==n?(N=r,r=e=P(i)):(J=r,r=n)):(J=r,r=n)),r}const{QuotedString:mt,VerbatimString:$t,Variable:kt,Word:Ct,List:wt,Whitespace:Et}=tokens;if((e=o())!==n&&J===t.length)return e;throw e!==n&&J<t.length&&at({type:"end"}),Tt=tt,Vt=Y<t.length?t.charAt(Y):null,Wt=Y<t.length?st(Y,Y+1):st(Y,Y),new peg$SyntaxError(peg$SyntaxError.buildMessage(Tt,Vt),Tt,Vt,Wt);var Tt,Vt,Wt}peg$subclass(peg$SyntaxError,Error),peg$SyntaxError.buildMessage=function(t,r){var e={literal:function(t){return'"'+i(t.text)+'"'},class:function(t){var r,e="";for(r=0;r<t.parts.length;r++)e+=t.parts[r]instanceof Array?o(t.parts[r][0])+"-"+o(t.parts[r][1]):o(t.parts[r]);return"["+(t.inverted?"^":"")+e+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function i(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function o(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}return"Expected "+function(t){var r,n,i,o=new Array(t.length);for(r=0;r<t.length;r++)o[r]=(i=t[r],e[i.type](i));if(o.sort(),o.length>0){for(r=1,n=1;r<o.length;r++)o[r-1]!==o[r]&&(o[n]=o[r],n++);o.length=n}switch(o.length){case 1:return o[0];case 2:return o[0]+" or "+o[1];default:return o.slice(0,-1).join(", ")+", or "+o[o.length-1]}}(t)+" but "+function(t){return t?'"'+i(t)+'"':"end of input"}(r)+" found."};var parser_1=(parser={SyntaxError:peg$SyntaxError,parse:peg$parse}).parse;const parse=t=>parser_1(t),replace=(t,r)=>{return parser_1(t).stringify(r)};exports.List=List,exports.QuotedString=QuotedString,exports.Variable=Variable,exports.VerbatimString=VerbatimString,exports.Whitespace=Whitespace,exports.Word=Word,exports.parse=parse,exports.replace=replace;
//# sourceMappingURL=index.js.map
